<html>
	<head>
		<title>City Scroller</title>
		<script src="http://cloud.github.com/downloads/processing-js/processing-js/processing-1.4.1.min.js"></script>
		<script type="text/processing" data-processing-target="mycanvas">

		Building testBuilding = new Building(0, random(30,100));
		Skyline instance = new Skyline();
		//TODO: Create an instance of your Skyline object

        //since these are variables we don't want to ever change in the code, we capitalize them
        var WINDOW_WIDTH = screen.width;
        var WINDOW_HEIGHT = 400;
        var SKYCOLOR = color(64, 159, 232);

        //This function only runs once at the start of the program
        void setup() {
          size(WINDOW_WIDTH, WINDOW_HEIGHT); //sets the size of the window
          frameRate(30); //how many times the draw function is called per second
        }

        //called repeatedly
        void draw() {
        	background(SKYCOLOR); //needed in the draw function to "clear" the screen between updates
	  			// testBuilding.drawAndUpdate();
					instance.moveSkyline();

	  		//TODO: Call drawSkyline on your Skyline object

        }


		class Skyline {
			ArrayList<Building> buildingList;
			var xPosition, bw;

			Skyline(){
				buildingList = new ArrayList<Building>();
				xPosition = 0;
				bw = 100;
				fillSkyline();//when a Skyline is created it automatically has enough buildings to fill the screen
			}

			void moveSkyline(){
				//TODO:update and draw the skyline, add buildings as buildings leave the screen
				drawSkyline();
				update();
			}

			void drawSkyline(){
				//TODO:loop through buildingList and draw each Building
				//println(buildingList.size());
				for(var i = 0; i < buildingList.size(); i++)
				{
					Building currentBuilding = buildingList.get(i);
					currentBuilding.drawBuilding();
				}
			}

			void update(){
				//TODO:loop through buildingList and update each Building
				for(var i=0; i < buildingList.size(); i++)
				{
					Building sampleBuilding = buildingList.get(i);
					sampleBuilding.update(4);
				}
			}

			void addBuilding(){
				var randomBuildingWidth = random(50,125);
				Building currentBuilding = new Building(xPosition, randomBuildingWidth);
				buildingList.add(currentBuilding);
				xPosition += randomBuildingWidth;
			}

			void fillSkyline(){
				//TODO:add enough buildings to fill the screen
				while(xPosition - 500 < screen.width)
				{
					addBuilding();
				}
			}
		}

        class Building {
        	var xPosition, yPosition, buildingHeight, buildingWidth;
        	var buildingColor;
        	Building(var xPos, var bw ) {
        		buildingHeight = random(30,250);
        		buildingWidth = bw;
        		xPosition = xPos;
        		buildingColor = color(102,123,155);
        	}

        	void drawAndUpdate()
					{
						var testSpeed = 5;
						drawBuilding();
						update(testSpeed);
					}

        	void drawBuilding(){
                fill(buildingColor);
        				rect(xPosition,WINDOW_HEIGHT- buildingHeight,buildingWidth,buildingHeight);
        	}

        	void update(var speed){
        		xPosition += speed;
						if(xPosition > width)
						{
							xPosition = -125;
						}
        	}

        }
        </script>
    </head>

    <body>
		<canvas id="mycanvas"></canvas>
	</body>
</html>
